<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="2159" MadCap:lastWidth="618">
    <head>
        <meta http_equiv="X-UA-Compatible" content="IE=EmulateIE7" />
        <meta http_equiv="Content-Language" content="ja-JP" /><title>タイムシートを開く際にシステムエラーが発生する</title>
        <link rel="StyleSheet" href="..\fx_support.css" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="System.Title" />
        </h1>
        <p class="title">問題の発生するバージョン</p>
        <p>TimeTracker FX 2.0.0以降</p>
        <p>&#160;</p>
        <p class="title">問題が修正されるバージョン</p>
        <p>未定</p>
        <p>&#160;</p>
        <p class="title">内容</p>
        <p>TimeTracker FXをアップグレードもしくは再インストール後、タイムシートを起動すると、システムエラーが発生して強制終了してしまう。</p>
        <p>
            <img src="../Image/TB061208_01.png" alt="" width="400" height="173" border="0" class="img_1" />
        </p>
        <p>&#160;</p>
        <p class="title">原因</p>
        <p>GAC（グローバル・アセンブリ・キャッシュ）に、以下のdllファイルの旧バージョンや、存在しないファイルのアドレスが登録されていることで発生します。</p>
        <ul type="disc">
            <li>
                <p>dllファイル　：Janus.Windows.Common.v3.dll</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title_3">□GACとは</p>
        <p class="p_5">GACには、Windowsがアプリケーションを起動する際の処理速度向上などを目的にdllファイルを登録します。</p>
        <ul type="disc">
            <li>
                <p>GACの登録一覧　：C:\WINDOWS\assembly</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p>なお、GACへの登録をTimeTracker FXが行うことはありません。</p>
        <p>手動または、他のアプリケーションで該当のdllファイルを登録した可能性があります。</p>
        <p>&#160;</p>
        <p class="title">回避方法</p>
        <p>GACに登録された情報を削除することで現象を回避することが可能です。</p>
        <p>本回避方法の概要手順は以下のとおりです。</p>
        <p>&#160;</p>
        <ol class="ol_1">
            <li>
                <p><a href="QA101222_01.htm#step1">エラー詳細の内容を確認します。</a>
                </p>
            </li>
            <li>
                <p><a href="QA101222_01.htm#step2">本現象への対応を実施するにあたり、以下の内容についてご確認いただき、その結果をサポートチームまでご連絡ください。</a>
                </p>
            </li>
            <li>
                <p><a href="QA101222_01.htm#step3">手順2にて確認していただいた内容をもとに、GACに登録された情報を削除しても問題がないかどうかを判断いたします。</a>
                </p>
            </li>
            <li>
                <p><a href="QA101222_01.htm#step4">TimeTracker FXを起動し、タイムシートの動作を確認します。</a>
                </p>
            </li>
        </ol>
        <p>&#160;</p>
        <p>以降に各手順の詳細を説明します。</p>
        <p>&#160;</p>
        <ol class="ol_1">
            <li>
                <p class="title">エラー詳細の内容を確認します。<a name="step1"></a></p>
            </li>
        </ol>
        <p class="p_2">表示されるエラーダイアログよりエラーの詳細をサポートチームまでご報告ください。</p>
        <p class="p_2">エラー報告の方法については、<a href="../Inquiry/TB061208_01.htm">こちら</a>をご覧ください。</p>
        <p>&#160;</p>
        <ol start="2" class="ol_1">
            <li>
                <p class="title">本現象への対応を実施するにあたり、以下の内容についてご確認いただき、その結果をサポートチームまでご連絡ください。<a name="step2"></a></p>
            </li>
        </ol>
        <p>&#160;</p>
        <p class="p_2">①GACへの利用状態の確認</p>
        <p class="p_2">プログラムを削除するあたり、該当プログラムの利用状態を確認いたします。</p>
        <p class="p_2">以下の手順で出力した結果の画面をサポートチームまで送信いただけますようお願い申し上げます。</p>
        <p>&#160;</p>
        <p class="p_4">【手順】</p>
        <p class="p_4">(1) Windows［スタート］メニューから、［ファイル名を指定して実行］を選択します。</p>
        <p class="p_4">(2) ［ファイル名を指定して実行］ダイアログの［名前］に cmd と入力し、［OK］をクリックします。</p>
        <p class="p_4">(3) 以下のコマンドを入力し、［Enter］キーを押下します。</p>
        <p class="p_3">-----------------------------</p>
        <p class="p_3">&#160;&#160;tasklist /M jan*</p>
        <p class="p_3">-----------------------------</p>
        <p class="p_4">(4) 出力結果が表示されますので、その画面をコピーして、サポートチームまでお送りください。</p>
        <p>&#160;</p>
        <p class="p_2">②他のアプリケーションへの影響の確認</p>
        <p class="p_2">プログラムを削除するにあたり、該当プログラムが他のアプリケーションで利用されていないか依存関係を確認いたします。</p>
        <p>&#160;</p>
        <p class="p_2">以下の手順で出力した結果をサポートチームまで送信いただけますよう、お願い申し上げます。</p>
        <p>&#160;</p>
        <p class="p_4">【手順】</p>
        <p class="p_4">(1) Windows［スタート］メニューから［ファイル名を指定して実行］を選択します。</p>
        <p class="p_4">(2) ［名前］に regedit と入力し、［OK］をクリックします。</p>
        <p class="p_4">(3) 以下のキーを開きます。</p>
        <p class="p_3">［マイ コンピュータ］－［HKEY_LOCAL_MACHINE］－［SOFTWARE］－［Classes］－［Installer］</p>
        <p class="p_4">(4) ［Installer］を右クリックして［エクスポート］を選択します。</p>
        <p class="p_4">(5) 任意のフォルダ、名前を指定して保存します。</p>
        <p class="p_3">※ 保存したファイルは、メモ帳等で内容を確認することができます。</p>
        <p class="p_4">(6) 保存したファイルの拡張子を「txt」に変更し、ファイルをサポートチームまでお送りください。</p>
        <p class="p_3">※ エクスポートされるデータは、プログラム間の依存関係の情報です。</p>
        <p class="p_27">ユーザ情報等は一切含まれません。</p>
        <p>&#160;</p>
        <p class="p_2">③該当dllファイルの所在（保存場所）の確認</p>
        <p class="p_2">プログラムを削除するにあたり、該当プログラムが保存されている場所を確認します。</p>
        <p>&#160;</p>
        <p class="p_2">以下の手順を実施いただき、表示された結果の画面をサポートチームまで送信いただきますよう、お願い申し上げます。</p>
        <p>&#160;</p>
        <p class="p_4">【手順】</p>
        <p class="p_4">(1) Windows［スタート］メニューから、［ファイル名を指定して実行］を選択します。</p>
        <p class="p_4">(2) ［ファイル名を指定して実行］ダイアログの［名前］に cmd と入力し、［OK］をクリックします。</p>
        <p class="p_4">(3) 以下のコマンドを入力し、［Enter］キーを押下します。</p>
        <p class="p_3">処理は、数分～10分程度かかる場合があります。</p>
        <p class="p_3">-----------------------------</p>
        <p class="p_3">&#160;&#160;dir /S c:\*common.v3.dll</p>
        <p class="p_3">-----------------------------</p>
        <p class="p_4">(4) 出力結果が表示されますので、その画面をコピーして、サポートチームまでお送りください。</p>
        <p>&#160;</p>
        <ol start="3" class="ol_1">
            <li>
                <p class="title">手順2にて確認していただいた内容をもとに、GACに登録された情報を削除しても問題がないかどうかを判断いたします。<a name="step3"></a></p>
            </li>
        </ol>
        <p class="p_2">問題がないことが確認できた場合、以下の手順にてGACに登録されている情報を削除いたします。</p>
        <p class="p_2">サポートチームからの指示がないままで、本手順を進めないでください。</p>
        <p>&#160;</p>
        <p class="p_4">【手順】</p>
        <p class="p_4">(1) Windows［スタート］メニューから、［ファイル名を指定して実行］をクリックします。</p>
        <p class="p_4">(2) ［ファイル名を指定して実行］ダイアログの［名前］に cmd と入力し、［OK］をクリックします。</p>
        <p class="p_4">(3) 以下のコマンドを入力し、［Enter］キーを押下します。</p>
        <p class="p_3">-----------------------------</p>
        <p class="p_3">&#160;&#160;cd C:\WINDOWS\assembly\GAC_MSIL</p>
        <p class="p_3">&#160;&#160;del /S Janus*</p>
        <p class="p_3">-----------------------------</p>
        <p class="p_4">(4) 出力結果が表示されますので、その画面をコピーし、サポートチームまでお送りください。</p>
        <p>&#160;</p>
        <ol start="4" class="ol_1">
            <li>
                <p class="title">TimeTracker FXを起動し、タイムシートの動作を確認します。<a name="step4"></a></p>
            </li>
        </ol>
    </body>
</html>