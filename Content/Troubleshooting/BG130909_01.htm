<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="5" MadCap:lastHeight="1242" MadCap:lastWidth="877">
    <head>
        <meta http_equiv="X-UA-Compatible" content="IE=EmulateIE7" /><title>Vista以降のOSでオートメーションAPIでAdministratorを起動するとエラーが発生する</title>
        <link href="../FX_KB.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="System.Title" />
        </h1>
        <h3>問題の発生するバージョン</h3>
        <p>TimeTracker FX 3以降</p>
        <h3>問題が修正されるバージョン</h3>
        <p>未定</p>
        <h2>内容</h2>
        <p>Windows Vista以降のOSでオートメーションAPIを使ってAdministratorを起動するときエラーが発生します。</p>
        <h3>【エラーの発生条件】</h3>
        <p class="p2">以下の条件を2つとも満たす場合に発生します。</p>
        <ol class="ol2">
            <li xmlns="">Windows Vista以降</li>
            <li xmlns="">オートメーションAPIを使用してAdministratorを起動</li>
        </ol>
        <p class="p2">※通常のAdministrator起動時には本エラーは発生しません。</p>
        <h3 xmlns="http://www.w3.org/1999/xhtml">【エラーの発生理由】</h3>
        <p class="p2">本エラーはAdministratorのオブジェクト取得コマンド（※）を実行したとき、オブジェクトの取得に失敗するために発生します。<br xmlns="http://www.w3.org/1999/xhtml" />※ VBA、VBScriptの場合はCreateObjectコマンド、JScriptの場合はActiveXObjectコマンド</p>
        <h3 xmlns="http://www.w3.org/1999/xhtml">【Excelマクロ（VBA）でのエラー表示】</h3>
        <p xmlns="http://www.w3.org/1999/xhtml" class="p2">
            <img src="../Image/BG1309090_01_1.png" xmlns="http://www.w3.org/1999/xhtml" />
        </p>
        <h2>回避方法</h2>
        <p>この現象は、Administratorのオブジェクト取得コマンドを実行後、発生するエラーを無視し、再度オブジェクト取得コマンドを実行することで回避できます。<br xmlns="http://www.w3.org/1999/xhtml" />以下に実行例を紹介します。</p>
        <h3 xmlns="http://www.w3.org/1999/xhtml">【VBA、VBScriptでの実行例】</h3>
        <table cellspacing="0" width="500" class="table_1" xmlns="http://www.w3.org/1999/xhtml">
            <col style="width: 100%;" xmlns="http://www.w3.org/1999/xhtml" />
            <tr valign="top" xmlns="http://www.w3.org/1999/xhtml">
                <td style="width: 100%;" class="td_1">
                    <p>' Administratorオブジェクトを取得する<br xmlns="http://www.w3.org/1999/xhtml" />On Error Resume Next<br xmlns="http://www.w3.org/1999/xhtml" />Call CreateObject("TimeTracker.Administrator.Application")<br xmlns="http://www.w3.org/1999/xhtml" />Err.Clear<br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" />' 再度Administratorオブジェクトを取得する<br xmlns="http://www.w3.org/1999/xhtml" />Set app = CreateObject("TimeTracker.Administrator.Application")<br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" />' ログインを実行します。<br xmlns="http://www.w3.org/1999/xhtml" />Call app.Login("Administrator", "")</p>&#160;</td>
            </tr>
        </table>
        <p xmlns="http://www.w3.org/1999/xhtml">&#160;</p>
        <h3 xmlns="http://www.w3.org/1999/xhtml">【JScriptでの実行例】</h3>
        <table cellspacing="0" width="500" class="table_1" xmlns="http://www.w3.org/1999/xhtml">
            <col style="width: 100%;" />
            <tr valign="top">
                <td style="width: 100%;" class="td_1">
                    <p>&#160;</p>
                    <p>try{<br xmlns="http://www.w3.org/1999/xhtml" />// Administratorオブジェクトを取得する<br xmlns="http://www.w3.org/1999/xhtml" />app = new ActiveXObject("TimeTracker.Administrator.Application");<br xmlns="http://www.w3.org/1999/xhtml" />} catch(e){<br xmlns="http://www.w3.org/1999/xhtml" />// 再度Administratorオブジェクトを取得する<br xmlns="http://www.w3.org/1999/xhtml" />app = new ActiveXObject("TimeTracker.Administrator.Application");<br xmlns="http://www.w3.org/1999/xhtml" />}</p>
                    <p>// ログインを実行します。<br xmlns="http://www.w3.org/1999/xhtml" />app.Login("Administrator", "");</p>
                </td>
            </tr>
        </table>
        <p xmlns="http://www.w3.org/1999/xhtml">&#160;</p>
    </body>
</html>