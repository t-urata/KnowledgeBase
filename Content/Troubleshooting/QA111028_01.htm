<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="1333" MadCap:lastWidth="1146">
    <head>
        <meta http_equiv="X-UA-Compatible" content="IE=EmulateIE7" /><title>オートメーションAPIを実行すると、CreateObjectにてエラーが発生する場合がある </title>
        <link href="../FX_KB.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="System.Title" />
        </h1>
        <h3>このトピックの対象</h3>
        <p class="p2">TimeTracker FX 2.5.0以降</p>
        <h2>症状</h2>
        <p>オートメーションAPIを実行すると以下のエラーが発生し、実行できない場合があります。</p>
        <p class="p_2">
            <img src="../Image/QA111028_01_1.png" alt="" width="361" height="186" border="0" class="img_1" />
        </p>
        <h2>原因と対策</h2>
        <p>Windows Vista以降のOSで、ユーザー アカウント制御（UAC）が有効な場合、<br xmlns="http://www.w3.org/1999/xhtml" />管理者を含む全てのユーザーは、既定で「標準ユーザー」としてアプリケーションを実行します。<br xmlns="http://www.w3.org/1999/xhtml" />オートメーションAPIを利用する場合にも「標準ユーザー」として実行しているため、<br xmlns="http://www.w3.org/1999/xhtml" />管理者権限が不足し、オブジェクト作成部分（CreateObject）にてエラーが発生する場合があります。</p>
        <p>この問題を回避してオートメーションAPIを実行するには、以下の2つの方法があります。</p>
        <ul type="disc">
            <li class="P">ユーザー アカウント制御を「無効」に設定する</li>
        </ul>
        <p class="p3">[スタート] ボタン、[コントロール パネル] の順にクリックします。<br xmlns="http://www.w3.org/1999/xhtml" />検索ボックスに「uac」と入力し、[ユーザー アカウント制御設定の変更] をクリックします。</p>
        <p class="p3">
            <img src="../Image/QA111028_01_2.png" alt="" width="494" height="364" border="0" class="img_1" />
        </p>
        <ul type="disc">
            <li class="P">オートメーションAPIの実行時のみ権限を昇格する</li>
        </ul>
        <p class="p3">※本操作は、オートメーションAPIを利用するファイルを起動する都度、実行します。<br xmlns="http://www.w3.org/1999/xhtml" />※以下の手順では、Excel VBAを利用する場合を例としてご説明しています。</p>
        <ol class="ol3">
            <li class="li_2">Windows［スタート］メニューから、［Ctrl］ボタン＋［Shift］ボタンを押しながらExcelをクリックします。</li>
            <li class="P">ユーザー アカウント制御が起動するので、[はい]を選択して管理者として実行します。</li>
            <img src="../Image/QA111028_01_3.png" alt="" width="394" height="222" border="0" class="img_1" />
            <li class="P">Excelの［ファイル］メニューからオートメーションAPIのマクロ（VBA）を含むファイルを開きます。</li>
            <li class="P">マクロ（VBA）を実行します。</li>
        </ol>
    </body>
</html>