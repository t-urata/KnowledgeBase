<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="8" MadCap:lastHeight="1910" MadCap:lastWidth="1010">
    <head>
        <meta http_equiv="X-UA-Compatible" content="IE=EmulateIE7" /><title>スクリプトからタイムシート・プランナーを起動する</title>
        <link href="../../FX_KB.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="System.Title" />
        </h1>
        <p>オートメーションAPIを使い、タイムシートやプロジェクト（プランナー）を自動的に起動するサンプルスクリプトです。</p>
        <h2>利用方法について</h2>
        <p>本サンプルスクリプトの利用方法を説明します。</p>
        <ol start="1" class="ol_1">
            <li class="p">ページ末尾の<a href="SA090629_02.htm#download">［ダウンロード］</a>より、［OpenProjects.zip］をクリックしてサンプルツールをダウンロードします。</li>
            <li class="p">ダウンロードした圧縮ファイルを、任意のフォルダへ展開します。</li>
            <li class="p">展開ファイルには、以下のサンプルスクリプトがございます。</li>
        </ol>
        <ul class="ul2">
            <li class="P" type="disc">OpenProjects.vbs<br xmlns="http://www.w3.org/1999/xhtml" />TimeTrackerFXを起動後、タイムシート及びプランナーを起動するサンプルスクリプトです。 
 <br xmlns="http://www.w3.org/1999/xhtml" />プランナーでは、リストで選択されたプロジェクトが［閲覧モード］で開きます。</li>
            <li class="P" type="disc">GetProjectList.vbs<br xmlns="http://www.w3.org/1999/xhtml" />OpenProjects.vbsで開くプロジェクトのリストを作成する、サンプルスクリプトです。</li>
        </ul>
        <h3>【タイムシートを自動的に起動する】</h3>
        <ol start="1" class="ol_1">
            <li class="p">メモ帳等エディタにてOpenProjects.vbsを開き、ログイン名・パスワードを入力し保存します。</li>
            <table cellspacing="0" width="555">
                <col width="18" />
                <col />
                <tr>
                    <td bgcolor="#C0C0C0" class="td_5">
                        <p class="p7">行</p>
                    </td>
                    <td bgcolor="#C0C0C0" class="td_2">
                        <p class="p7">サンプルスクリプトのコード</p>
                    </td>
                </tr>
                <tr>
                    <td class="td_6">
                        <p class="p7">21<br xmlns="http://www.w3.org/1999/xhtml" />22</p>
                    </td>
                    <td class="td_4">
                        <p class="p7">' ログインを実行します。（ログイン名,パスワード）<br xmlns="http://www.w3.org/1999/xhtml" />Call app.Login("okamoto", "")</p>
                    </td>
                </tr>
            </table>
            <ul>
                <li class="p_information">パスワードを設定していない場合は、パスワードの入力は不要です。</li>
            </ul>
            <li class="p">OpenProjects.vbsをダブルクリックします。</li>
            <li class="p">タイムシートが開いた状態で、TimeTrackerFXが起動します。</li>
        </ol>
        <h3>【タイムシートとプロジェクトを自動的に起動する】</h3>
        <ol start="1" class="ol_1">
            <li class="p">メモ帳等エディタにてGetProjectList.vbsを開き、ログイン名・パスワードを入力し保存します。</li>
            <table cellspacing="0" width="555">
                <col width="18" />
                <col />
                <tr>
                    <td bgcolor="#C0C0C0" class="td_5">
                        <p class="p7">行</p>
                    </td>
                    <td bgcolor="#C0C0C0" class="td_2">
                        <p class="p7">サンプルスクリプトのコード</p>
                    </td>
                </tr>
                <tr>
                    <td class="td_6">
                        <p class="p7">21<br />22</p>
                    </td>
                    <td class="td_4">
                        <p class="p7">' ログインを実行します。（ログイン名,パスワード）<br />Call app.Login("okamoto", "")</p>
                    </td>
                </tr>
            </table>
            <ul>
                <li class="p_information">パスワードを設定していない場合は、パスワードの入力は不要です。</li>
            </ul>
            <li class="p">GetProjectList.vbsをダブルクリックします。</li>
            <li class="p">GetProjectList.vbsと同じフォルダに、ProjectList.csvが作成されます。</li>
            <li class="p">ProjectList.csvには、ログインしたアカウントがマネージャに設定されているプロジェクトが出力されます。</li>
            <li class="p">ProjectList.csvをエディタにて開き、起動したいプロジェクトを選択します。<br />	選択するプロジェクトは、"0"から"1"に変更してください。<br /><img src="../../Image/SA090629_02_1.png" alt="" width="480" height="64" border="0" class="img_1" /></li>
            <li class="p">OpenProjects.vbsをダブルクリックします。</li>
            <li class="p">タイムシートと、選択したプロジェクトが［閲覧モード］で開いた状態で、TimeTrackerFXが起動します。</li>
        </ol>
        <h2>サンプルスクリプトの編集について</h2>
        <p>本サンプルスクリプトを、用途に応じて編集する場合の一例を紹介します。</p>
        <h3>【プロジェクトを編集モードで起動する場合】</h3>
        <ol start="1" class="ol_1">
            <li class="p">OpenProjects.vbsをエディタにて開き、以下の編集をし保存します。</li>
            <ul type="disc">
                <li class="p">61行目の先頭の'（コメント）を削除します。</li>
                <li class="p">62行目の先頭に'をつけコメントアウトします。</li>
            </ul>
            <table cellspacing="0" width="555" class="table_1">
                <col width="18" />
                <col />
                <tr>
                    <td bgcolor="#C0C0C0" class="td_5">
                        <p class="p7">行</p>
                    </td>
                    <td bgcolor="#C0C0C0" class="td_2">
                        <p class="p7">サンプルスクリプトのコード</p>
                    </td>
                </tr>
                <tr>
                    <td class="td_6">
                        <p class="p7">60<br xmlns="http://www.w3.org/1999/xhtml" />61<br xmlns="http://www.w3.org/1999/xhtml" />62</p>
                    </td>
                    <td class="td_4">
                        <p class="p7">' プロジェクトを開きます（プロジェクトID,モード）<br xmlns="http://www.w3.org/1999/xhtml" />Call app.OpenProject(strProject(0), 0) ' 編集モード<br xmlns="http://www.w3.org/1999/xhtml" />'Call app.OpenProject(strProject(0), 1) ' 閲覧モード</p>
                    </td>
                </tr>
            </table>
        </ol>
        <ol start="2" class="ol_1">
            <li class="p">OpenProjects.vbsをダブルクリックします。</li>
            <li class="p">タイムシートと、選択したプロジェクトが［編集モード］で開いた状態で、TimeTrackerFXが起動します。</li>
        </ol>
        <ul class="ul2">
            <li class="p_warning">
                <p class="p7">選択したプロジェクトが別のアカウントによって、既に編集モードで開かれている場合は、<MadCap:toggler targets="t1">エラー</MadCap:toggler>が発生しプロジェクトが開けません。</p>
                <div MadCap:targetName="t1">
                    <img src="../../Image/SA090629_02_2.png" alt="" width="494" height="161" border="0" class="img_1" />
                </div>
            </li>
            <li class="p_information">
                <p>ログインユーザの［計画閲覧］・［計画作成・編集］権限によって制限があります。詳細については、<a href="../../newdoc/Planner_Application_OpenProject.htm" target="_blank">こちら</a>をご覧ください。</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p>【ProjectList.csvに全てのプロジェクトを出力する場合】</p>
        <ol start="1" class="ol_1">
            <li class="p">GetProjectList.vbsをエディタにて開き、以下の編集をし保存します。</li>
            <ul type="disc">
                <li class="p">53行目の先頭の'（コメント）を削除します。</li>
                <li class="p">56行目の先頭に'をつけコメントアウトします。</li>
            </ul>
            <table cellspacing="0" width="650" class="table_1">
                <col width="18" />
                <col />
                <tr>
                    <td bgcolor="#C0C0C0" class="td_5">
                        <p class="p7">行</p>
                    </td>
                    <td bgcolor="#C0C0C0" class="td_2">
                        <p class="p7">サンプルスクリプトのコード</p>
                    </td>
                </tr>
                <tr>
                    <td class="td_6">
                        <p class="p7">50<br xmlns="http://www.w3.org/1999/xhtml" />51<br xmlns="http://www.w3.org/1999/xhtml" />52<br xmlns="http://www.w3.org/1999/xhtml" />53<br xmlns="http://www.w3.org/1999/xhtml" />54<br xmlns="http://www.w3.org/1999/xhtml" />55<br xmlns="http://www.w3.org/1999/xhtml" />56</p>
                    </td>
                    <td class="td_4">
                        <p class="p7">' 一覧で取得するプロジェクトを設定します。<br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" />' プロジェクト一覧（すべてのプロジェクト,終了したプロジェクトは表示しない）<br xmlns="http://www.w3.org/1999/xhtml" />Set projectList = app.GetProjects(False, False)<br xmlns="http://www.w3.org/1999/xhtml" /><br xmlns="http://www.w3.org/1999/xhtml" />' プロジェクト一覧（自分がマネージャのプロジェクト,終了したプロジェクトは表示しない）<br xmlns="http://www.w3.org/1999/xhtml" />'Set projectList = app.GetProjects(True, False)</p>
                    </td>
                </tr>
            </table>
        </ol>
        <ol start="2" class="ol_1">
            <li class="p">GetProjectList.vbsをダブルクリックします。</li>
            <li class="p">GetProjectList.vbsと同じフォルダに、ProjectList.csvが作成されます。</li>
            <li class="p">ProjectList.csvには、すべての有効なプロジェクトが出力されます。</li>
            <li class="p_info">ログインユーザの［計画閲覧］・［計画作成・編集］権限によって制限があります。詳細については、<a href="../../newdoc/Planner_Application_OpenProject.htm" target="_blank">こちら</a>をご覧ください。</li>
        </ol>
        <h3>【PC起動時にTimeTrackerFXを同時に起動する場合】</h3>
        <p class="p2">WindowsのスタートアップにOpenProjects.vbsのショートカットを置く事で、PC起動時にTimeTrackerFXを同時に起動できます。</p>
        <h3>出力する情報について</h3>
        <p class="p2">GetProjectList.vbsは、以下の情報をProjectList.csv（CSVファイル）に出力します。</p>
        <ul>
            <li class="p" type="disc">プロジェクトID</li>
            <li class="p" type="disc">組織ID</li>
            <li class="p" type="disc">組織名</li>
            <li class="p" type="disc">プロジェクトコード</li>
            <li class="p" type="disc">プロジェクト名</li>
            <li class="p" type="disc">対象フラグ</li>
            <ul>
                <li class="p_information">"1"の場合、OpenProjects.vbsで開く対象のプロジェクトとして選択されます。</li>
            </ul>
        </ul>
        <h2>サンプルスクリプトの活用について</h2>
        <p>本サンプルツールを自社の業務にあわせて自由に編集できます。<br xmlns="http://www.w3.org/1999/xhtml" />編集方法についてのお問い合わせは受け付けておりません。オートメーションの詳細は、オートメーションヘルプをご覧ください。</p>
        <h3>ダウンロード</h3>
        <ul>
            <li class="p_download"><a href="../../downloads/sample/OpenProjects.zip" target="_blank">OpenProjects.zip</a>･･･ZIP（2KB）<a name="download"></a></li>
        </ul>
        <p>&#160;</p>
    </body>
</html>