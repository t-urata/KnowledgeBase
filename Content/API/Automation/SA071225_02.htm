<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:id="サンプルスクリプト - スケルトンコード" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:fileTags="RoboHelpStatus.完了">
    <head>
        <meta http_equiv="X-UA-Compatible" content="IE=EmulateIE7" /><title>スクリプトからTimeTracker FXを起動する</title>
        <link rel="StyleSheet" href="../../fx_support.css" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="System.Title" />
        </h1>
        <p>オートメーションAPIを使い、TimeTracker FXを起動して終了するまでの基本的な動作を行うスクリプトです。</p>
        <p>&#160;</p>
        <p class="title">使用するメソッド</p>
        <p>以下のメソッドについて説明します。</p>
        <p>各メソッドの説明にある、サンプルスクリプトの抜粋は、［<a href="SA071225_02.htm#download">ダウンロード</a>］から入手できるスクリプトの抜粋です。</p>
        <ul type="disc">
            <li class="p">
                <p>CreateObject･･･アプリケーションを起動する</p>
            </li>
            <li class="p">
                <p>IsLoggedIn･･･ログイン状態を確認する</p>
            </li>
            <li class="p">
                <p>Login･･･ログインする</p>
            </li>
            <li class="p">
                <p>Quit･･･アプリケーションを終了する</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">アプリケーションを起動する</p>
        <p>オートメーションを使用するためにアプリケーションオブジェクトを作成します。</p>
        <p>タイムシート、プランナー、Administratorの3つのアプリケーションのいずれかを指定します。</p>
        <p>サンプルスクリプトでは、タイムシート（TimeSheet）を指定しています。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t5">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t5">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>36</p>
                                <p>37</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'アプリケーションを起動します。(TimeSheet)</p>
                                <p>Set app = CreateObject("TimeTracker.TimeSheet.Application")</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">ログイン状態を確認する</p>
        <p>スクリプトを実行したクライアントPCで、TimeTracker FXのログイン状態を確認します。</p>
        <p>サンプルスクリプトでは、ログインしている場合は何もせずに終了します。</p>
        <ul>
            <li class="p_warning_1">
                <p class="warning">ログイン中にオートメーションAPIを実行すると、編集中のデータが失われることがあります。</p>
            </li>
        </ul>
        <ul>
            <li class="p_info_1">
                <p>ログインしていない状態で、オートメーションAPIを実行することをお勧めします。</p>
            </li>
        </ul>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t4">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t4">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>41</p>
                                <p>42</p>
                                <p>43</p>
                                <p>44</p>
                                <p>45</p>
                                <p>46</p>
                                <p>47</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'ログイン状態を確認します。</p>
                                <p>isLogined = app.IsLoggedIn</p>
                                <p>If (isLogined) Then</p>
                                <p>'何もせず終了</p>
                                <p>WScript.Echo "TimeTracker FXを終了してください"</p>
                                <p>Wscript.Quit</p>
                                <p>Else</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">ログインする</p>
        <p>TimeTracker FXにログインします。</p>
        <p>サンプルスクリプトでは、コマンドラインの引数で指定してます。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t3">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t3">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>49</p>
                                <p>50</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'ログインを実行します。</p>
                                <p>Call app.Login(strUser,strPass)</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">アプリケーションを終了する</p>
        <p>オートメーションAPIが起動したTimeTracker FXを終了します。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t2">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t2">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>68</p>
                                <p>69</p>
                                <p>70</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'アプリケーションを終了します。</p>
                                <p>app.Quit</p>
                                <p>Set app = Nothing</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">サンプルスクリプトの利用方法について</p>
        <p>メソッドの説明に使用したサンプルスクリプトの利用方法を記述します。</p>
        <ol class="ol_1">
            <li class="p">
                <p>ページ末尾の<a href="SA071225_02.htm#download">［ダウンロード］</a>より、［SkeletonCode.zip］をクリックしてサンプルスクリプトをダウンロードします。</p>
            </li>
            <li class="p">
                <p>ダウンロードした圧縮ファイルを、任意のフォルダへ展開します。</p>
            </li>
            <li class="p">
                <p>TimeTracker FXを起動している場合は、データを保存して終了します。</p>
            </li>
            <li class="p">
                <p>コマンドプロンプトを起動します。</p>
            </li>
            <li class="p">
                <p>以下のコマンドを入力します。</p>
            </li>
        </ol>
        <table cellspacing="0" width="550" class="table_1">
            <col style="width: 100%;" />
            <tr valign="top">
                <td style="width: 100%;" class="td_1">
                    <p>cd サンプルスクリプトを展開したフォルダ</p>
                    <p>cscript.exe SkeletonCode.vbs ログイン名 パスワード</p>
                </td>
            </tr>
        </table>
        <ul>
            <li class="p_info">
                <p class="p_5">実行例は <MadCap:toggler targets="t1">こちら</MadCap:toggler>をご覧ください。</p>
                <div MadCap:targetName="t1">
                    <table cellspacing="0" width="700">
                        <col style="width: 100%;" />
                        <tr valign="top">
                            <td style="width: 100%;" bgcolor="#C0C0C0" class="td_1">
                                <p>C:\&gt;<span class="span_1">cd Sample</span></p>
                                <p>C:\Sample&gt;<span class="span_1">cscript 
				 SkeletonCode.vbs okamoto password</span></p>
                                <p>Microsoft (R) Windows Script Host Version 5.6</p>
                                <p>Copyright (C) Microsoft Corporation 1996-2001. All rights 
				 reserved.</p>
                                <p>&#160;</p>
                                <p>C:\Sample&gt;</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">出力する情報について</p>
        <p>本サンプルスクリプトは、TimeTracker FXの情報を出力しません。</p>
        <p>&#160;</p>
        <p class="title">サンプルスクリプトの活用について</p>
        <p>本スクリプトは、オートメーションAPIを利用するための基本的な骨組みを提供するものです。</p>
        <p>TimeTracker FXナレッジベースで公開する多くのスクリプトは、このスケルトンコードを利用しています。</p>
        <ul>
            <li class="p_info_1">
                <p>本スクリプトの詳細は、<a href="KB071225_02.htm">こちら</a>をご覧ください。</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">ダウンロード<a name="download" id="download"></a></p>
        <ul>
            <li class="p_download">
                <p class="download"><a href="../../downloads/sample/SkeletonCode.zip">SkeletonCode.zip</a>･･･ZIP（32KB）</p>
            </li>
        </ul>
        <p>&#160;</p>
    </body>
</html>