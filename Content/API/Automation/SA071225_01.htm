<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:id="サンプルスクリプト - 指定した日の作業実績を取得する" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:fileTags="RoboHelpStatus.完了">
    <head>
        <meta http_equiv="X-UA-Compatible" content="IE=EmulateIE7" /><title>指定した日の作業実績を取得する</title>
        <link rel="StyleSheet" href="../../fx_support.css" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="System.Title" />
        </h1>
        <p>TimeSheet.Application.GetActualTimesメソッドを使い、タイムシートから指定日の作業実績を取得するためのサンプルスクリプトです。</p>
        <p>&#160;</p>
        <p class="title">使用するメソッド</p>
        <p>以下のメソッドについて説明します。</p>
        <p>各メソッドの説明にある、サンプルスクリプトの抜粋は、［<a href="SA071225_01.htm#download">ダウンロード</a>］から入手できるスクリプトの抜粋です。</p>
        <ul type="disc">
            <li class="p">
                <p>LoginUser･･･TimeTracker FXにログインしているユーザの情報を取得する</p>
            </li>
            <li class="p">
                <p>Load･･･指定期間の実績をタイムシートに表示する</p>
            </li>
            <li class="p">
                <p>GetActualTimes･･･タイムシートから実績を取得する</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">アカウント名を取得する</p>
        <p>スクリプト実行時に指定したログイン名を使い、アカウント名を取得します。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t6">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t6">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>84</p>
                                <p>85</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'ログインユーザの情報を取得します。</p>
                                <p>Set loginUser = app.LoginUser()</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">データベースから作業実績を取得する</p>
        <p>データベースから作業実績を取得し、タイムシートに表示します。</p>
        <p>サンプルスクリプトでは、スクリプトの起動時に指定した日付の実績を取得します。</p>
        <ul>
            <li class="p_info_1">Loadメソッドを使うと、 <a href="../../newdoc/basic_option.htm" target="_blank" id="a3">［実績入力･閲覧範囲の指定］</a>で指定できない範囲の実績を表示できます。</li>
        </ul>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t5">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t5">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>91</p>
                                <p>92</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'作業実績を読み込みます。</p>
                                <p>Call app.Load(strDate, strDate)</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">タイムシートから実績を取得する</p>
        <p>タイムシートに表示した作業実績のコレクションを取得します。</p>
        <p>取得した値は、それぞれの作業実績にインデックスを割り当てたリストです。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t4">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t4">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>94</p>
                                <p>95</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'作業実績を取得します。</p>
                                <p>Set actulaTimeList = app.GetActualTimes</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">作業実績を出力する</p>
        <p>指定した日付の作業実績の情報を取得します。</p>
        <p>作業実績のコレクションのメンバをループ処理で取得して、標準出力に出力します。</p>
        <ul>
            <li class="p_info_1">作業時間（Timeプロパティ）の単位は分です。サンプルスクリプトでは、時間（H）に変換しています。</li>
        </ul>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t3">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t3">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>97</p>
                                <p>98</p>
                                <p>99</p>
                                <p>100</p>
                                <p>101</p>
                                <p>102</p>
                                <p>103</p>
                                <p>104</p>
                                <p>105</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'作業実績の情報を出力します。</p>
                                <p>For Each actualTime In actulaTimeList</p>
                                <p class="p_2">WScript.Echo actualTime.ProjectName 
				 &amp; "," &amp;_</p>
                                <p class="p_2">actualTime.TaskName &amp; 
				 "," &amp;_</p>
                                <p class="p_2">FormatDateTime(actualTime.Start, 
				 4) &amp; "," &amp;_</p>
                                <p class="p_2">FormatDateTime(actualTime.Finish, 
				 4) &amp; "," &amp;_</p>
                                <p class="p_2">FormatNumber((actualTime.Time/60), 
				 2) &amp; "," &amp;_</p>
                                <p class="p_2">actualTime.Memo</p>
                                <p>Next</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">サンプルスクリプトの利用方法について</p>
        <p>メソッドの説明に使用したサンプルスクリプトの利用方法を記述します。</p>
        <ol start="1" class="ol_1">
            <li class="p">
                <p>ページ末尾の<a href="#download">［ダウンロード］</a>より、［GetActualTimesOneDay.zip］をクリックしてサンプルスクリプトをダウンロードします。</p>
            </li>
            <li class="p">
                <p>ダウンロードした圧縮ファイルを、任意のフォルダへ展開します。</p>
            </li>
            <li class="p">
                <p>TimeTracker FXを起動している場合は、データを保存して終了します。</p>
            </li>
            <li class="p">
                <p>コマンドプロンプトを起動します。</p>
            </li>
            <li class="p">
                <p>以下のコマンドを入力します。</p>
            </li>
        </ol>
        <table cellspacing="0" width="550" class="table_1">
            <col style="width: 100%;" />
            <tr valign="top">
                <td style="width: 100%;" class="td_1">
                    <p>cd サンプルスクリプトを展開したフォルダ</p>
                    <p>cscript.exe GetActualTimesOneDay.vbs 実績取得日 ログイン名 パスワード</p>
                </td>
            </tr>
        </table>
        <ul>
            <li class="p_info">
                <p class="p_5">実行例は <MadCap:toggler targets="t2">こちら</MadCap:toggler>をご覧ください。</p>
                <div MadCap:targetName="t2">
                    <table cellspacing="0" width="700">
                        <col style="width: 100%;" />
                        <tr valign="top">
                            <td style="width: 100%;" bgcolor="#C0C0C0" class="td_1">
                                <p>C:\&gt;<span class="span_1">cd Sample</span></p>
                                <p>C:\Sample&gt;<span class="span_1">cscript.exe 
				 GetActualTimesOneDay.vbs 2007/12/17 okamoto password</span></p>
                                <p>Microsoft (R) Windows Script Host Version 5.6</p>
                                <p>Copyright (C) Microsoft Corporation 1996-2001. All rights 
				 reserved.</p>
                                <p>&#160;</p>
                                <p>岡本 直哉さんの2007/12/17の実績</p>
                                <p>プロジェクト名,タスク名,開始時刻,終了時刻,作業時間（H）,メモ</p>
                                <p>パッケージソフトTの開発,要求事項の確立,16:00,17:00,1.00,</p>
                                <p>パッケージソフトTの開発,ソフトウェア要求事項の評価,17:00,18:00,1.00,</p>
                                <p>パッケージソフトTの開発,関係者共同レビュー,18:00,19:00,1.00,</p>
                                <p>&#160;</p>
                                <p>C:\Sample&gt;</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">出力した作業実績をCSVファイルに保存するには</p>
        <p>以下の手順で、出力した作業実績をCSVファイルに保存できます。</p>
        <ol class="ol_1">
            <li class="p">
                <p>以下のコマンドを入力します。</p>
            </li>
        </ol>
        <table cellspacing="0" width="650" class="table_1">
            <col style="width: 100%;" />
            <tr valign="top">
                <td style="width: 100%;" class="td_1">
                    <p>cd サンプルスクリプトを展開したフォルダ</p>
                    <p>cscript.exe //NoLogo GetActualTimesOneDay.vbs 実績取得日 ログイン名 パスワード 
		 &gt;ActualTimes.csv</p>
                </td>
            </tr>
        </table>
        <ul>
            <li class="p_info">
                <p class="p_5">実行例は <MadCap:toggler targets="t1">こちら</MadCap:toggler>をご覧ください。</p>
                <div MadCap:targetName="t1">
                    <table cellspacing="0" width="750">
                        <col style="width: 100%;" />
                        <tr valign="top">
                            <td style="width: 100%;" bgcolor="#C0C0C0" class="td_1">
                                <p>C:\&gt;<span class="span_1">cd Sample</span></p>
                                <p>C:\Sample&gt;<span class="span_1">cscript.exe 
				 //NoLogo GetActualTimesOneDay.vbs 2007/12/17 okamoto password 
				 &gt;ActualTimes.csv</span></p>
                                <p>&#160;</p>
                                <p>C:\Sample&gt;</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <ol start="2" class="ol_1">
            <li class="p">
                <p>サンプルスクリプトを展開したフォルダに、CSVファイルが作成されます。</p>
            </li>
        </ol>
        <p>&#160;</p>
        <p class="title">出力する情報について</p>
        <p>本サンプルスクリプトは、以下の情報を出力します。</p>
        <table cellspacing="0" width="650" class="table_1">
            <col style="width: 16.546%;" />
            <col style="width: 83.454%;" />
            <tr valign="top">
                <td style="width: 16.546%;" bgcolor="#C0C0C0" class="td_1">
                    <p>フィールド</p>
                </td>
                <td style="width: 83.454%;" bgcolor="#C0C0C0" class="td_2">
                    <p>内容</p>
                </td>
            </tr>
            <tr valign="top">
                <td style="width: 16.546%;" class="td_3">
                    <p>プロジェクト名</p>
                </td>
                <td style="width: 83.454%;" class="td_4">
                    <p>プロジェクト名です。</p>
                </td>
            </tr>
            <tr valign="top">
                <td style="width: 16.546%;" class="td_3">
                    <p>タスク名</p>
                </td>
                <td style="width: 83.454%;" class="td_4">
                    <p>タスク名です。</p>
                </td>
            </tr>
            <tr valign="top">
                <td style="width: 16.546%;" class="td_3">
                    <p>開始時刻</p>
                </td>
                <td style="width: 83.454%;" class="td_4">
                    <p>作業実績の開始時刻です。</p>
                </td>
            </tr>
            <tr valign="top">
                <td style="width: 16.546%;" valign="middle" class="td_3">
                    <p>終了時刻</p>
                </td>
                <td style="width: 83.454%;" class="td_4">
                    <p>差表実績の終了時刻です。</p>
                </td>
            </tr>
            <tr valign="top">
                <td style="width: 16.546%;" valign="middle" class="td_3">
                    <p>作業時間（H）</p>
                </td>
                <td style="width: 83.454%;" class="td_4">
                    <p>作業時間です。単位は、時間（Hour）です。</p>
                </td>
            </tr>
            <tr valign="top">
                <td style="width: 16.546%;" valign="middle" class="td_3">
                    <p>メモ</p>
                </td>
                <td style="width: 83.454%;" class="td_4">
                    <p>作業実績に入力したメモです。</p>
                </td>
            </tr>
        </table>
        <p>&#160;</p>
        <p class="title">サンプルスクリプトの活用について</p>
        <p>本サンプルスクリプトを自社の業務にあわせて自由に編集できます。</p>
        <p>編集方法についてのお問い合わせは受け付けておりません。オートメーションの詳細は、オートメーションヘルプをご覧ください。</p>
        <p>&#160;</p>
        <p class="title">ダウンロード<a name="download" id="download"></a></p>
        <ul>
            <li class="p_download">
                <p class="download"><a href="../../downloads/sample/GetActualTimesOneDay.zip">GetActualTimesOneDay.zip</a>･･･ZIP（33KB）</p>
            </li>
        </ul>
        <p>&#160;</p>
    </body>
</html>