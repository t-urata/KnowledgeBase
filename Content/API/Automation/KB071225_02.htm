<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Primary.非公開" MadCap:id="解説 - 指定した日の作業実績を取得する（前編）" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:fileTags="RoboHelpStatus.完了">
    <head><title>解説 - スケルトンコード</title>
        <link rel="StyleSheet" href="../../fx_support.css" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="System.Title" />
        </h1>
        <p>オートメーションAPIを利用するための基本的な骨組みで構成した<a href="../../Automation/SA071225_02.htm">［サンプルスクリプト - スケルトンコード］</a>について解説します。</p>
        <p>本解説は、［サンプルスクリプト - スケルトンコード］のコードと一緒にご覧ください。</p>
        <p>&#160;</p>
        <p class="title">説明するメソッド</p>
        <p>本解説では、以下のメソッドについて説明します。</p>
        <ul type="disc">
            <li class="p">
                <p>CreateObject･･･アプリケーションを起動する</p>
            </li>
            <li class="p">
                <p>IsLoggedIn･･･ログイン状態を確認する</p>
            </li>
            <li class="p">
                <p>Login･･･ログインする</p>
            </li>
            <li class="p">
                <p>Quit･･･アプリケーションを終了する</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">アプリケーションを起動する</p>
        <p>オートメーションを使用するためにアプリケーションオブジェクトを作成します。</p>
        <p>タイムシート、プランナー、Administratorの3つのアプリケーションのいずれかを指定します。</p>
        <p>サンプルスクリプトでは、タイムシート（TimeSheet）を指定しています。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t4">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t4">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>36</p>
                                <p>37</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'アプリケーションを起動します。(TimeSheet)</p>
                                <p>Set app = CreateObject("TimeTracker.TimeSheet.Application")</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">ログイン状態を確認する</p>
        <p>スクリプトを実行したクライアントPCで、TimeTracker FXのログイン状態を確認します。</p>
        <p>サンプルスクリプトでは、ログインしている場合は何もせずに終了します。</p>
        <ul>
            <li class="p_warning_1">
                <p class="warning">ログイン中にオートメーションAPIを実行すると、編集中のデータが失われることがあります。</p>
            </li>
            <li class="p_info_1">
                <p class="info">ログインしていない状態で、オートメーションAPIを実行することをお勧めします。</p>
            </li>
        </ul>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t3">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t3">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>41</p>
                                <p>42</p>
                                <p>43</p>
                                <p>44</p>
                                <p>45</p>
                                <p>46</p>
                                <p>47</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'ログイン状態を確認します。</p>
                                <p>isLogined = app.IsLoggedIn</p>
                                <p>If (isLogined) Then</p>
                                <p>'何もせず終了</p>
                                <p>WScript.Echo "TimeTracker FXを終了してください"</p>
                                <p>Wscript.Quit</p>
                                <p>Else</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">ログインする</p>
        <p>TimeTracker FXにログインします。</p>
        <p>サンプルスクリプトでは、コマンドラインの引数で指定してます。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t2">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t2">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>49</p>
                                <p>50</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'ログインを実行します。</p>
                                <p>Call app.Login(strUser,strPass)</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">アプリケーションを終了する</p>
        <p>オートメーションAPIが起動したTimeTracker FXを終了します。</p>
        <ul type="disc">
            <li class="p">
                <p>
                    <MadCap:toggler targets="t1">サンプルスクリプト（抜粋）</MadCap:toggler>
                </p>
                <div MadCap:targetName="t1">
                    <table cellspacing="0" width="500">
                        <col style="width: 16.476%;" />
                        <col style="width: 83.524%;" />
                        <tr valign="top">
                            <td style="width: 16.476%;" bgcolor="#C0C0C0" class="td_5">
                                <p>行</p>
                            </td>
                            <td style="width: 83.524%;" bgcolor="#C0C0C0" class="td_2">
                                <p>サンプルスクリプトのコード</p>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td style="width: 16.476%;" class="td_6">
                                <p>68</p>
                                <p>69</p>
                                <p>70</p>
                            </td>
                            <td style="width: 83.524%;" class="td_4">
                                <p>'アプリケーションを終了します。</p>
                                <p>app.Quit</p>
                                <p>Set app = Nothing</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </li>
        </ul>
        <p>&#160;</p>
    </body>
</html>