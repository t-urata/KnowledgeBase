<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:fileTags="RoboHelpStatus.完了">
    <head><title>オートメーションで、タイムシートのタスクツリーを読み込むと、ダイアログが表示される場合がある</title>
        <link rel="StyleSheet" href="../fx_support.css" type="text/css" />
    </head>
    <body>
        <h1>オートメーションで、タイムシートのタスクツリーを読み込むと、ダイアログが表示される場合がある</h1>
        <p class="title">影響を受けるアプリケーションオブジェクト</p>
        <p>次のアプリケーションオブジェクトで発生します。</p>
        <ul type="disc">
            <li class="p">
                <p>TimeSheet</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">概要</p>
        <p>TimeSheet で、Load ・ Reload メソッドを呼び出すと、下記条件下で［確認］ダイアログが表示されます。</p>
        <p>制御が GUI に移るため、以降のオートメーション処理が継続不能となります。</p>
        <p>&#160;</p>
        <p class="title">前提条件</p>
        <p>カレントタイムシートで、実績編集操作を行っており、それらが未保存の状態である場合に発生します。</p>
        <p>&#160;</p>
        <p class="title">現象を発生させる処理</p>
        <p>次のメソッドのうち、いずれかを呼び出した場合に発生します。</p>
        <ul type="disc">
            <li class="p">
                <p>TimeSheet.Load( )</p>
            </li>
            <li class="p">
                <p>TimeSheet.Reload( )</p>
            </li>
        </ul>
        <p>&#160;</p>
        <p class="title">発生する現象</p>
        <p>［確認:］ダイアログが開き、保存の確認を求められます。</p>
        <p>それにより、以降のオートメーションの処理を継続できません。</p>
        <p>&#160;</p>
        <p class="title">回避方法</p>
        <p>［確認:］ダイアログが表示された場合は、以降の動作が保証できませんので、オートメーション処理を終了させてください。</p>
        <p>&#160;</p>
        <p>本不具合を回避するためには、「事前に、他のアカウントにログインして、対象のアカウントの実績を破棄する」手順を追加してください。</p>
        <ol class="ol_1">
            <li class="p">
                <p>別のアカウントを指定して、 TimeSheet.Login( ) メソッドを呼び出します。</p>
            </li>
            <li class="p">
                <p>呼び出し前の編集内容が無条件で破棄されて、1で指定したアカウントの TimeSheet が開きます。</p>
            </li>
            <li class="p">
                <p>続けて、元のアカウントを指定して、 TimeSheet.Login( ) メソッドを呼び出します。</p>
            </li>
            <li class="p">
                <p>元のアカウントの TimeSheet が開きます。</p>
            </li>
            <li class="p">
                <p>4の結果、割り当てられたタスクは最新のものになります。</p>
            </li>
        </ol>
        <p>&#160;</p>
        <ul>
            <li class="p_info_1">
                <p class="info">未保存の実績を、事前に保存することでも回避できます。</p>
            </li>
        </ul>
        <p>&#160;</p>
    </body>
</html>